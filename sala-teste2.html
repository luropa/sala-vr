<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="utf-8" />
    <title>Sala de Estudo VR</title>
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/mayognaise/aframe-look-at-billboard@master/dist/aframe-look-at-billboard-component.min.js"></script>
  </head>
  <body>
    <a-scene>
      <!-- Câmera fixa a 4.5 metros da lousa -->
      <a-entity id="cameraRig" position="0 1.6 -4.5">
        <a-camera id="camera" look-controls></a-camera>
      </a-entity>

      <!-- Lousa -->
      <a-plane id="lousa" position="0 2 0" width="4" height="2" color="#222"></a-plane>

      <!-- Texto digitado -->
      <a-text id="texto-digitado" value="" position="-1.7 2.6 0.01" width="3" color="white"></a-text>

      <!-- Campo de texto (invisível visualmente, mas funcional para digitação) -->
      <a-entity id="campo-texto" visible="false">
        <a-plane position="0 1.3 0.01" width="3" height="0.3" color="#555"></a-plane>
      </a-entity>

      <!-- Teclado virtual -->
      <a-entity id="teclado" visible="false">
        <!-- Exemplo de teclas -->
        <a-box class="tecla" letra="N" position="-1.5 0.5 0.01" width="0.3" height="0.3" depth="0.1" color="#ccc"></a-box>
        <a-box class="tecla" letra="I" position="-1 0.5 0.01" width="0.3" height="0.3" depth="0.1" color="#ccc"></a-box>
        <a-box class="tecla" letra="H" position="-0.5 0.5 0.01" width="0.3" height="0.3" depth="0.1" color="#ccc"></a-box>
        <a-box class="tecla" letra="O" position="0 0.5 0.01" width="0.3" height="0.3" depth="0.1" color="#ccc"></a-box>

        <!-- Botões Entrar e Apagar -->
        <a-box id="botao-entrar" position="1 0.5 0.01" width="0.5" height="0.3" depth="0.1" color="green"></a-box>
        <a-text value="Entrar" position="0.9 0.55 0.05" width="1" color="white"></a-text>

        <a-box id="botao-apagar" position="1.7 0.5 0.01" width="0.5" height="0.3" depth="0.1" color="red"></a-box>
        <a-text value="Apagar" position="1.6 0.55 0.05" width="1" color="white"></a-text>
      </a-entity>

      <!-- Estrela contente -->
      <a-image id="estrela-contente" src="#estrelaContente" position="0 2 0.05" visible="false" width="1" height="1"></a-image>

      <!-- Estrela triste -->
      <a-image id="estrela-triste" src="#estrelaTriste" position="0 2 0.05" visible="false" width="1" height="1"></a-image>

      <!-- Recursos das imagens -->
      <a-assets>
        <img id="estrelaContente" src="estrela-contente.png">
        <img id="estrelaTriste" src="estrela-triste.png">
      </a-assets>

      <!-- Ambiente (mantido) -->
      <a-box position="0 0.25 -5" width="10" height="0.5" depth="10" color="#c2b280"></a-box>
      <a-box position="0 2 -10" width="10" height="4" depth="0.5" color="#8B4513"></a-box>
      <a-box position="-5 2 0" width="0.5" height="4" depth="10" color="#8B4513"></a-box>
      <a-box position="5 2 0" width="0.5" height="4" depth="10" color="#8B4513"></a-box>
    </a-scene>

    <script>
      let palavra = "";
      let acertou = false;

      // Mostra teclado/campo ao olhar fixamente
      const lousa = document.querySelector("#lousa");
      let timeoutOlhar = null;

      lousa.addEventListener("mouseenter", () => {
        if (acertou) return;
        timeoutOlhar = setTimeout(() => {
          document.querySelector("#teclado").setAttribute("visible", true);
          document.querySelector("#campo-texto").setAttribute("visible", true);
          document.querySelector("#texto-digitado").setAttribute("visible", true);
        }, 2000);
      });

      lousa.addEventListener("mouseleave", () => {
        clearTimeout(timeoutOlhar);
      });

      // Letras clicadas
      document.querySelectorAll(".tecla").forEach(tecla => {
        tecla.addEventListener("click", () => {
          if (acertou) return;
          palavra += tecla.getAttribute("letra");
          document.querySelector("#texto-digitado").setAttribute("value", palavra);
        });
      });

      // Botão Apagar
      document.querySelector("#botao-apagar").addEventListener("click", () => {
        if (acertou) return;
        palavra = palavra.slice(0, -1);
        document.querySelector("#texto-digitado").setAttribute("value", palavra);
      });

      // Botão Entrar
      document.querySelector("#botao-entrar").addEventListener("click", () => {
        if (palavra.toLowerCase() === "ninho") {
          acertou = true;
          mostrarEstrela("contente", 3000);
        } else {
          mostrarEstrela("triste", 5000);
          palavra = "";
          document.querySelector("#texto-digitado").setAttribute("value", "");
        }
      });

      function mostrarEstrela(tipo, duracao) {
        const estrela = document.querySelector(`#estrela-${tipo}`);
        estrela.setAttribute("visible", true);
        document.querySelector("#teclado").setAttribute("visible", false);
        document.querySelector("#campo-texto").setAttribute("visible", false);
        document.querySelector("#texto-digitado").setAttribute("visible", false);

        setTimeout(() => {
          estrela.setAttribute("visible", false);

          if (!acertou) {
            document.querySelector("#teclado").setAttribute("visible", true);
            document.querySelector("#campo-texto").setAttribute("visible", true);
            document.querySelector("#texto-digitado").setAttribute("visible", true);
          }
        }, duracao);
      }
    </script>
  </body>
</html>
