<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="utf-8">
  <title>Sala com Gaze e Movimento Contínuo</title>
  <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
  <style>
    body { margin: 0; overflow: hidden; }
  </style>
  <script>
    AFRAME.registerComponent('gaze-move', {
      schema: {
        speed: { type: 'number', default: 1.5 }
      },
      tick: function (time, deltaTime) {
        const direction = new THREE.Vector3();
        const cameraEl = this.el.querySelector('[camera]');
        if (!cameraEl) return;

        const d = this.data.speed * (deltaTime / 1000);

        cameraEl.object3D.getWorldDirection(direction);
        direction.y = 0;  // impede subir ou descer
        direction.normalize();

        this.el.object3D.position.add(direction.multiplyScalar(d));
      }
    });
  </script>
</head>

<body>
  <a-scene>
    <!-- Chão -->
    <a-plane position="0 0 0" rotation="-90 0 0" width="100" height="100" color="#7BC8A4"></a-plane>

    <!-- Rig com câmera e movimento por olhar -->
    <a-entity id="rig" position="0 1.6 0" gaze-move>
      <a-entity 
        camera 
        look-controls 
        wasd-controls-enabled="false">
        <a-cursor 
          fuse="true" 
          fuse-timeout="500" 
          color="red"
          geometry="primitive: ring; radiusInner: 0.01; radiusOuter: 0.02"
          material="color: red; shader: flat"
          position="0 0 -1">
        </a-cursor>
      </a-entity>
    </a-entity>

    <!-- Luzes -->
    <a-entity light="type: ambient; color: #ccc"></a-entity>
    <a-entity light="type: directional; color: #fff; intensity: 0.7" position="0 10 5"></a-entity>
  </a-scene>
</body>
</html>
