<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <title>Sala 360A</title>
  <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
</head>

<body>
<a-scene>

  <!-- ================= ASSETS ================= -->
  <a-assets>
    <a-asset-item id="holoModel" src="3d+robot+model.glb"></a-asset-item>

    <img id="img-ninho" src="palavraninho.png" />
    <img id="img-estrela" src="estrelacontente.png" />
    <img id="img-estrela-triste" src="estrelatriste.png" />
    <img id="velha" src="jvelha.jpg" />
    <img id="jogo" src="brinquedo educativo2.png" />
    <img id="img-climbing" src="parededeescalada1.png" />
    <img id="img-maoesquerda" src="maoesquerda.png" />
    <img id="img-maodireita" src="maodireita.png" />
  </a-assets>

  <!-- ================= LUZES ================= -->
  <a-entity light="type: ambient; intensity: 1.2; color: #ffffff"></a-entity>
  <a-entity light="type: directional; intensity: 0.5; color: #ffffff"
            position="2 4 1"></a-entity>

  <!-- ================= SALA ================= -->
  <a-plane src="piso1.png" width="10" height="10"
           rotation="-90 0 0"></a-plane>

  <a-plane width="10" height="5" position="0 2.5 -5"
           material="src: paredeerodape2.png"></a-plane>

  <a-plane width="10" height="5" position="0 2.5 5"
           rotation="0 180 0"
           material="src: paredeerodape2.png"></a-plane>

  <a-plane width="10" height="5" position="-5 2.5 0"
           rotation="0 90 0"
           material="src: paredeerodape2.png"></a-plane>

  <a-plane width="10" height="5" position="5 2.5 0"
           rotation="0 -90 0"
           material="src: paredeerodape2.png"></a-plane>

  <!-- ================= ROBÔ (WRAPPER) ================= -->

  <!-- Wrapper = posição fixa no centro da sala -->
  <a-entity id="holoWrapper" position="0 1.2 0">

    <!-- Robô -->
    <a-entity id="holo"
      gltf-model="#holoModel"
      scale="4.5 4.5 4.5"
      material="opacity: 0.8; transparent: true;
                emissive: #00aaff; emissiveIntensity: 0.3"
      animation__float="property: position;
                        dir: alternate;
                        dur: 4000;
                        easing: easeInOutSine;
                        loop: true;
                        to: 0 0.25 0">
    </a-entity>

  </a-entity>

  <!-- ================= CÂMERA ================= -->
  <a-entity id="cameraRig" position="0 0.5 4">
    <a-camera look-controls wasd-controls-enabled="true">
      <a-cursor fuse="true" fuse-timeout="2000"
        geometry="primitive: ring; radiusInner: 0.01; radiusOuter: 0.02"
        material="color: red; shader: flat">
      </a-cursor>
    </a-camera>
  </a-entity>

</a-scene>

<!-- ================= SCRIPT DO ROBÔ ================= -->
<script>
  const wrapper = document.querySelector("#holoWrapper");
  const holo = document.querySelector("#holo");

  let girando = false;
  let rotacaoAtual = 0;
  let totalRotacao = 0;
  let animacaoAtiva = true;

  function girar() {
    if (girando && animacaoAtiva) {
      const velocidade = 4;
      rotacaoAtual += velocidade;
      totalRotacao += Math.abs(velocidade);

      wrapper.setAttribute("rotation", {
        x: 0,
        y: rotacaoAtual,
        z: 0
      });

      if (totalRotacao >= 360) {
        animacaoAtiva = false;
        girando = false;
        return;
      }
      requestAnimationFrame(girar);
    }
  }

  holo.addEventListener("mouseenter", () => {
    if (animacaoAtiva) {
      girando = true;
      girar();
    }
  });

  holo.addEventListener("mouseleave", () => {
    girando = false;
  });
</script>

</body>
</html>
