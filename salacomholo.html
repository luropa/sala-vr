<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="utf-8">
  <title>Sala 360A com Robô</title>

  <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>

  <!-- ================= COMPONENTE DA LOUSA ================= -->
  <script>
    AFRAME.registerComponent('interacao-lousa', {
      init: function () {
        const lousa = this.el;
        const teclado = document.querySelector('#teclado');
        const palavra = document.querySelector('#palavraNinho');

        lousa.addEventListener('mouseenter', () => {
          teclado.setAttribute('visible', true);
          palavra.setAttribute('visible', true);
        });
      }
    });
  </script>

</head>

<body>

<a-scene>

  <!-- ================= ASSETS ================= -->
  <a-assets>
    <img id="estrelaFeliz" src="estrelafeliz.png">
    <img id="estrelaTriste" src="estrelatriste.png">
    <a-asset-item id="modeloRobo" src="robo.glb"></a-asset-item>
  </a-assets>

  <!-- ================= CAMERA / GAZE ================= -->
  <a-entity id="cameraRig">
    <a-camera>
      <a-cursor
        fuse="true"
        fuse-timeout="1500"
        raycaster="objects: .interativo"
        geometry="primitive: ring; radiusInner: 0.01; radiusOuter: 0.015"
        material="color: black; shader: flat">
      </a-cursor>
    </a-camera>
  </a-entity>

  <!-- ================= LOUSA ================= -->
  <a-image
    id="lousa"
    class="interativo"
    src="lousaembranco2.png"
    position="0 2 -4"
    width="3"
    height="2"
    interacao-lousa>
  </a-image>

  <a-image
    id="palavraNinho"
    src="ninho.png"
    position="0 3 -3.9"
    visible="false"
    width="1.5"
    height="0.5">
  </a-image>

  <!-- ================= TECLADO ================= -->
  <a-entity
    id="teclado"
    position="0 1.2 -3.8"
    visible="false">
    <!-- teclas aqui -->
  </a-entity>

  <!-- ================= FEEDBACK ================= -->
  <a-image
    id="estrelaPositiva"
    src="#estrelaFeliz"
    position="0 2.5 -3"
    visible="false">
  </a-image>

  <a-image
    id="estrelaNegativa"
    src="#estrelaTriste"
    position="0 2.5 -3"
    visible="false">
  </a-image>

  <!-- ================= PAREDE DE ESCALADA ================= -->
  <a-plane
    id="paredeEscalada"
    position="3 2 -2"
    rotation="0 -90 0"
    width="4"
    height="4"
    color="#ccc">
  </a-plane>

  <a-image
    id="pegadas2"
    class="interativo"
    src="pegadas.png"
    position="2.9 1.5 -2">
  </a-image>

  <!-- ================= ROBÔ ================= -->
  <a-entity
    id="roboWrapper"
    position="-1.6 2.0 2.9"
    rotation="0 90 0">

    <a-entity
      id="roboEducacional"
      gltf-model="#modeloRobo"
      rotation="0 0 0"
      scale="1.5 1.5 1.5"
      animation="property: position;
                 dir: alternate;
                 dur: 4000;
                 easing: easeInOutSine;
                 loop: true;
                 to: 0 0.3 0">
    </a-entity>

  </a-entity>

</a-scene>

<!-- ================= SCRIPT PRINCIPAL ================= -->
<script>
window.addEventListener('load', () => {

  const estrelaBoa = document.querySelector('#estrelaPositiva');
  const estrelaRuim = document.querySelector('#estrelaNegativa');
  const pegadas = document.querySelector('#pegadas2');
  const cameraRig = document.querySelector('#cameraRig');

  pegadas.addEventListener('mouseenter', () => {
    cameraRig.setAttribute('position', '2.5 1.6 -2');
  });

  function feedbackCorreto() {
    estrelaBoa.setAttribute('visible', true);
    setTimeout(() => estrelaBoa.setAttribute('visible', false), 2000);
  }

  function feedbackErrado() {
    estrelaRuim.setAttribute('visible', true);
    setTimeout(() => estrelaRuim.setAttribute('visible', false), 2000);
  }

});
</script>

</body>
</html>
