<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <title>Sala 360A</title>
  <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
</head>

<body>
<a-scene>

  <!-- ================= ASSETS ================= -->
  <a-assets>
    <a-asset-item id="modeloCadeira" src="cadeira_final.glb"></a-asset-item>
    <a-asset-item id="modeloRobo" src="3d+robot+model.glb"></a-asset-item>

    <img id="img-ninho" src="palavraninho.png">
    <img id="img-estrela" src="estrelacontente.png">
    <img id="img-estrela-triste" src="estrelatriste.png">
    <img id="velha" src="jvelha.jpg">
    <img id="jogo" src="brinquedo educativo2.png">
    <img id="img-climbing" src="parededeescalada1.png">
    <img id="img-maoesquerda" src="maoesquerda.png">
    <img id="img-maodireita" src="maodireita.png">
  </a-assets>

  <!-- ================= LUZ ================= -->
  <a-light type="ambient" color="#ffffff" intensity="1.2"></a-light>

  <!-- ================= AMBIENTE ================= -->
  <a-plane src="piso1.png" width="10" height="10" rotation="-90 0 0"></a-plane>

  <a-plane width="10" height="5" position="0 2.5 -5" material="src: paredeerodape2.png"></a-plane>
  <a-plane width="10" height="5" position="-5 2.5 0" rotation="0 90 0" material="src: paredeerodape2.png"></a-plane>
  <a-plane width="10" height="5" position="5 2.5 0" rotation="0 -90 0" material="src: paredeerodape2.png"></a-plane>

  <!-- ================= LOUSA ================= -->
  <a-image id="lousa"
           interacao-lousa
           src="lousaembranco2.png"
           width="5.6"
           height="3.1"
           position="0 2.5 -4.95">
  </a-image>

  <a-image id="imagem-ninho"
           src="#img-ninho"
           width="1"
           height="0.5"
           position="0 3 -4.9"
           visible="false">
  </a-image>

  <a-text id="texto-digitado"
          value=""
          position="0 2.5 -4.9"
          color="#000"
          align="center"
          width="3"
          visible="false">
  </a-text>

  <a-entity id="teclado" visible="false"></a-entity>

  <!-- ================= PEGADAS ================= -->
  <a-image id="pegadas1"
           src="pegadas.png"
           width="0.8"
           height="0.8"
           rotation="-90 0 0"
           position="0 0.01 -2">
  </a-image>

  <!-- ================= ROBÃ” ================= -->
  <a-entity id="robo"
            gltf-model="#modeloRobo"
            position="-4.2 1.4 -4.2"
            rotation="0 310 0"
            scale="2.5 2.5 2.5"
            visible="false">
  </a-entity>

  <!-- ================= CÃ‚MERA ================= -->
  <a-entity id="cameraRig" position="0 0.5 4">
    <a-camera>
      <a-cursor fuse="true"
                fuse-timeout="1500"
                color="red">
      </a-cursor>
    </a-camera>
  </a-entity>

</a-scene>

<!-- ================= SCRIPT ================= -->
<script>
/* ========= VARIÃVEIS ========= */
const robo = document.querySelector('#robo');
const cameraRig = document.querySelector('#cameraRig');
const pegadasLousa = document.querySelector('#pegadas1');

let roboApareceu = false;

/* ========= EFEITO TV ========= */
function aparecerRoboComEfeitoTV() {
  if (roboApareceu) return;
  roboApareceu = true;

  console.log('ðŸ¤– RobÃ´ aparecendo');

  robo.setAttribute('visible', true);
  robo.setAttribute('scale', '0.05 3 0.05');

  robo.setAttribute('animation__glitch', {
    property: 'scale',
    dur: 120,
    dir: 'alternate',
    loop: 8,
    to: '2.5 2.0 2.5'
  });

  setTimeout(() => {
    robo.removeAttribute('animation__glitch');

    robo.setAttribute('animation__normal', {
      property: 'scale',
      dur: 700,
      easing: 'easeOutElastic',
      to: '2.5 2.5 2.5'
    });

    robo.setAttribute('animation__float', {
      property: 'position',
      dir: 'alternate',
      dur: 3000,
      loop: true,
      easing: 'easeInOutSine',
      to: '-4.2 2.0 -4.2'
    });
  }, 1000);
}

/* ========= TELEPORTE PEGADAS ========= */
pegadasLousa.addEventListener('click', () => {
  const pos = pegadasLousa.object3D.position.clone();
  cameraRig.object3D.position.set(pos.x, cameraRig.object3D.position.y, pos.z + 0.6);
  aparecerRoboComEfeitoTV();
});

/* ========= LOUSA ========= */
AFRAME.registerComponent('interacao-lousa', {
  init: function () {
    this.el.addEventListener('mouseenter', () => {
      document.querySelector('#imagem-ninho').setAttribute('visible', true);
      document.querySelector('#texto-digitado').setAttribute('visible', true);
    });
  }
});
</script>

</body>
</html>
